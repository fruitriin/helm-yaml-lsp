{{/*
============================================================================
Helm専用機能 - include/template参照、.Release変数
============================================================================

【テスト目的】
- include "xxx" の "xxx" 部分へのジャンプ機能
- template "xxx" の "xxx" 部分へのジャンプ機能
- .Release.* 変数のホバー表示

【動作確認方法】
1. F5でExtension Development Hostを起動
2. このファイルを開く
3. include "argo-workflow-sample.labels" の "argo-workflow-sample.labels" にカーソルを置いてF12
4. .Release.Name にカーソルを置いてホバー

【期待動作】
✅ "argo-workflow-sample.labels" → _helpers.tpl の define定義にジャンプ
✅ .Release.Name → ホバーで "リリース名" の説明が表示される
============================================================================
*/}}

apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "argo-workflow-sample.fullname" . }}-helm-test
  namespace: {{ .Values.namespace }}
  labels:
    # ---------------------------------------------------------------------
    # 【確認ポイント】include参照のジャンプ
    # 操作: "argo-workflow-sample.labels" にカーソルを置いてF12
    # 期待: _helpers.tpl の define "argo-workflow-sample.labels" にジャンプ
    # ---------------------------------------------------------------------
    {{- include "argo-workflow-sample.labels" . | nindent 4 }}
data:
  # ---------------------------------------------------------------------------
  # 【確認ポイント】include参照（基本形）
  # 操作: "argo-workflow-sample.name" にカーソルを置いてF12
  # 期待: _helpers.tpl の define "argo-workflow-sample.name" にジャンプ
  # ---------------------------------------------------------------------------
  name: {{ include "argo-workflow-sample.name" . }}

  # ---------------------------------------------------------------------------
  # 【確認ポイント】シングルクォート + include
  # 操作: 'argo-workflow-sample.fullname' にカーソルを置いてF12
  # 期待: _helpers.tpl の define "argo-workflow-sample.fullname" にジャンプ
  # ---------------------------------------------------------------------------
  fullname: {{ include "argo-workflow-sample.fullname" . }}

  # ---------------------------------------------------------------------------
  # 【確認ポイント】template 関数
  # 操作: "argo-workflow-sample.name" にカーソルを置いてF12
  # 期待: _helpers.tpl の define "argo-workflow-sample.name" にジャンプ
  # ---------------------------------------------------------------------------
  via-template: {{ template "argo-workflow-sample.name" . }}

  # ---------------------------------------------------------------------------
  # 【確認ポイント】.Release 変数のホバー
  # 操作: .Release.Name にカーソルを置いてホバー
  # 期待: "リリース名" などの説明が表示される
  # ---------------------------------------------------------------------------
  release-name: {{ .Release.Name }}
  release-namespace: {{ .Release.Namespace }}
  release-service: {{ .Release.Service }}
  release-revision: "{{ .Release.Revision }}"

  release-info: |
    Name: {{ .Release.Name }}
    Namespace: {{ .Release.Namespace }}
    Service: {{ .Release.Service }}
    Revision: {{ .Release.Revision }}
