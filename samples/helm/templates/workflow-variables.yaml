{{- if .Values.workflow.enabled }}
{{/*
============================================================================
workflow.* 変数 - ワークフロー情報へのアクセス（Helm版）
============================================================================

【テスト目的】
- workflow.*変数のホバー表示
- Helm変数とArgo workflow変数の混在
- workflow.parametersの定義へのジャンプ機能

【動作確認方法】
1. F5でExtension Development Hostを起動
2. このファイルを開く
3. workflow.name にカーソルを置いてホバー
4. workflow.parameters.message の "message" にカーソルを置いてF12

【期待動作】
✅ workflow.name: ホバーで "ワークフロー名" などの説明が表示される
✅ workflow.parameters.message: 定義にジャンプ
============================================================================
*/}}

apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: {{ include "argo-workflow-sample.fullname" . }}-variables-
  namespace: {{ .Values.namespace }}
  labels:
    {{- include "argo-workflow-sample.labels" . | nindent 4 }}
spec:
  entrypoint: main
  arguments:
    parameters:
      - name: message
        value: "Hello from workflow parameters"
      - name: count
        value: "5"
  templates:
    - name: main
      container:
        image: {{ .Values.workflow.image.repository }}:{{ .Values.workflow.image.tag }}
        command: [sh, -c]
        args:
          - |
            echo "=== Workflow Variables ==="
            echo "Name: {{`{{workflow.name}}`}}"
            echo "Namespace: {{`{{workflow.namespace}}`}}"
            echo "Parameters: {{`{{workflow.parameters.message}}`}}"
            echo "Count: {{`{{workflow.parameters.count}}`}}"
{{- end }}
