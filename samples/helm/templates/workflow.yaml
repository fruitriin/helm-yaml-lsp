{{- if .Values.workflow.enabled }}
# ============================================================================
# テスト用サンプルWorkflow（Helm版）
# ============================================================================
#
# 【注意】
# このファイルは自動テスト用のサンプルファイルです。
# 実際の機能別サンプルは以下を参照してください：
# - workflow-basic.yaml
# - workflow-parameters.yaml
# - configmap-helm.yaml（Helm機能のテスト）
# など
# ============================================================================

apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: {{ .Release.Name }}-test-
  namespace: {{ .Release.Namespace }}
  labels:
    app.kubernetes.io/instance: {{ .Release.Name }}
    {{- if .Release.IsInstall }}
    install-phase: "true"
    {{- end }}
spec:
  entrypoint: main
  templates:
    - name: main
      steps:
        - - name: step-hello
            template: hello

    - name: hello
      container:
        image: alpine:latest
        command: [echo]
        args:
          - "Release Name: {{ .Release.Name }}"
          - "Namespace: {{ .Release.Namespace }}"
          {{- if .Release.IsInstall }}
          - "This is an install operation"
          {{- end }}
{{- end }}
